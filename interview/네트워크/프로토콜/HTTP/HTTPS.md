
## HTTPS의 탄생
### HTTP의 문제
- HTTPS는 HTTP의 문제점으로 인해서 발생하였다.
	- 기존 HTTP는 암호화되지 않은 평문으로 통신되었기 때문에 패킷을 탈취하여 어떤 메세지가 오고갔는지 확인할 수 있었다.
	- 요청, 응답된 상대가 검증되었는지 확인하지 않는다.

## HTTP + SSL => HTTPS
- SSL을 사용하면 HTTP와 SSL이 통신하고 SSL과 TCP가 통신하게 된다. 이렇게 통신하는 방식을 HTTPS라고 부른다.
- 443 포트를 사용한다.
- 암호화 : 가로채어도 데이터를 해독할 수 없다.
- 무결성 : 데이터가 변조되지 않도록 보장한다. 
- 대칭키, 비대칭키를 사용한다.


#### 대칭키
- 공유된 하나의 키로 암/복호화를 함
**단점**
- 중간에 누가 키를 탈취할 수 있음

#### 비대칭키 (=공개키)
- key pair를 둔다. 개인키, 공개키가 존재한다.
- A키로 암호화하면 B키로만 복호화 가능하다. B키로 암호화하면 A키로만 복호화 가능하다.
- 사용자(공개키) -> 서버 (개인키) 사용자가 요청을 보낼 때 공개키로 암호화하여 요청하면, 해커가 탈취할 수 없다. 이 암호화된 데이터를 복호화할 수 있는건 개인키를 가진 서버 뿐이기 때문이다.
단점
- 컴퓨터에 큰 부담을 준다.


신뢰할 수 있는 정보인 걸 어떻게 알지?
- 개인키로 보낸 데이터를 공개키로 복호화하여 검증할 수 있는 사이트(CA)로 알 수 있다.

> **CA(Certificate Authority)**
> - 공개키 인증 해주는 공인된 민간 기업

#### TLS handshake 과정
1. 클라이언트가 서버에게 Client Hello 과정으로 TLS 통신 하겠다 요청
2. 서버가 클라이언트에게 Server hello 과정으로 인증서 전달
3. 클라이언트가 인증서 확인하고 프리마스터 시크릿 (공개키로 암호화) 생성
4. 서버가 프리마스터 시크릿(개인키로 암호화) 활용해서 세션키(= 대칭키) 생성해서 응답


**client hello 과정** ^310949
- 클라이언트 -> 랜덤 데이터 -> 서버
- 클라이언트가 서버로 브라우저가 사용하는 SSL, TLS 버전 정보와 지원하는 **사이퍼 수트(암호화 방식), 난수**를 전달한다.
**server hello 과정**
- 클라이언트 <- 랜덤 데이터 + 인증서 <-서버
- 서버가 사이퍼 수트를 선택하고 인증서와 함께 난수를 전달한다.
**브라우저가 서버 인증서 확인**
- 클라이언트의 브라우저에 저장된 **CA의 정보**로 통해 **인증서를 검증**한다
**브라우저의 프리마스터 시크릿**
- 브라우저는 자신이 생성한 난수와 서버의 난수를 사용해 **프리마스터 시크릿을 생성**합니다. 이때 인증서에 딸려온 공개키로 암호화하여 서버로 전송합니다.
**서버의 프리마스터 시크릿 복호화**
- 복호화한 값을 마스터 시크릿 값으로 저장합니다. **클라이언트 난수 + 서버 난수 + 마스터 시크릿** 값으로 **세션키**를 생성합니다. 이것이 데이터를 주고받을 때 사용하는 대칭키가 됩니다.
**SSL 핸드세이크 종료, HTTPS 통신 시작**
복호화된 인증서에는 서버의 공개키가 포함되어 있음


비대칭키 - 컴퓨터에 큰 부담을 준다. (일일이 암호화하기는 어렵다) 그래서 대칭키를 사용함. 대칭키를 공유할 때 비대칭키를 사용한다.


https://www.youtube.com/watch?v=H6lpFRpyl14
